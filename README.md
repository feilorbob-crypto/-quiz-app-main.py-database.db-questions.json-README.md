# quiz-app-main.py-database.db-questions.json-README.md

Система подготовки к экзаменам по ГОСТ и СТ РК — приложение для изучения и проверки знаний нормативных документов с подробными пояснениями и ссылками на действующие пункты стандартов.

## 1) Проверка одного ответа (`exam_checker.py`)

Скрипт `exam_checker.py`:
- принимает JSON из `stdin` с полями `question`, `options`, `correct_index`, `user_index`, `source`;
- проверяет правильность выбранного пользователем варианта;
- возвращает строго валидный JSON в `stdout`;
- использует нормативный источник только если он присутствует во входных данных.

Пример запуска:

```bash
python exam_checker.py <<'JSON'
{
  "question": "Что такое водоцементное отношение?",
  "options": [
    "Отношение массы воды к массе цемента",
    "Отношение массы цемента к массе воды",
    "Отношение объёма воды к объёму заполнителя",
    "Отношение массы заполнителя к массе цемента"
  ],
  "correct_index": 0,
  "user_index": 2,
  "source": {
    "document_number": "ГОСТ 7473-2010",
    "document_title": "Смеси бетонные",
    "year": 2010,
    "clause": "3.6"
  }
}
JSON
```

## 2) Формат `questions.json`

`quiz_runner.py` принимает файл с вопросами в одном из двух форматов:
- объект с ключом `questions` (рекомендуется);
- либо корневой массив вопросов.

### Рекомендуемый формат

```json
{
  "questions": [
    {
      "question": "Строка вопроса",
      "options": ["Вариант 1", "Вариант 2", "Вариант 3"],
      "correct_index": 0,
      "source": {
        "document_number": "ГОСТ 7473-2010",
        "document_title": "Смеси бетонные",
        "year": 2010,
        "clause": "3.6"
      }
    }
  ]
}
```

Поля вопроса:
- `question` *(string, обязательно)* — текст вопроса;
- `options` *(string[], обязательно)* — варианты ответов;
- `correct_index` *(int, обязательно)* — индекс правильного варианта (нумерация с 0);
- `source` *(object, опционально)* — нормативный источник. Если есть, он передаётся в `exam_checker.py` без изменений.

Готовый пример лежит в `questions.example.json`.

## 3) Запуск теста из файла (`quiz_runner.py`)

`quiz_runner.py` запускает серию вопросов из файла и для каждого ответа вызывает `evaluate(...)` из `exam_checker.py`.

Интерактивный запуск:

```bash
python quiz_runner.py --questions questions.json
```

Неинтерактивный запуск (для авто-проверки):

```bash
python quiz_runner.py --questions questions.json --answers 3,1,2 --output result.json
```

Где:
- `--answers` — ответы в **1-базной** нумерации (чтобы пользователю было привычнее);
- `--output` — путь сохранения итогового JSON-отчёта.

## 4) Конвертация текстового блока вопросов в JSON (`question_converter.py`)

Добавлен скрипт `question_converter.py`, который читает блок вопросов из `stdin` и возвращает **только JSON-массив** со структурой:

```json
{
  "question": "…",
  "options": ["…", "…", "…", "…"],
  "correct_index": 0,
  "explanation": ""
}
```

Поддерживаемые пометки:
- начало вопроса: `1. ...` или `1) ...`;
- варианты: `A) ...`, `B) ...`, `C) ...`, `D) ...` (или `А) ...`, `Б) ...`, `В) ...`, `Г) ...`);
- правильный ответ: строки вида `Правильный ответ: B` / `Correct answer: 2`.

Если правильный ответ не найден, выставляется `correct_index: -1`.

Пример:

```bash
python question_converter.py <<'TXT'
1. Что такое водоцементное отношение?
A) Отношение массы воды к массе цемента
B) Отношение массы цемента к массе воды
C) Отношение объёма воды к объёму заполнителя
D) Отношение массы заполнителя к массе цемента
Правильный ответ: A
TXT
```


## 5) Уточнения по валидации

- `exam_checker.py` валидирует тип `source`: допускается только объект JSON (или отсутствие поля).
- При ошибке валидации или невалидном JSON `exam_checker.py` возвращает JSON-объект вида `{ "error": "..." }` и завершается с кодом 1 (без Python traceback в stdout).
- `quiz_runner.py` не прерывает весь прогон на вопросах с `correct_index = -1`: такие вопросы помечаются как пропущенные в отчёте (`skipped: true`).
